<!DOCTYPE html>
<html lang="en-GB" xml:lang="en-GB" xmlns="http://www.w3.org/1999/xhtml">
<head>

	<title>Security Tab</title>

	<meta charset="UTF-8" />

	<link rel="stylesheet" type="text/css" href="./security.css" media="all" />

</head>
<body>

	<h1>Security Tab Ideas</h1>

	<p id="intro">Suggestions, comments, ideas all welcome on <a href="https://github.com/craigfrancis/dev-security">GitHub</a>.</p>

	<div id="window" class="https">
		<nav>
			<ul>
				<li>
					<a href="#tls" title="Transport Layer Security"><span>TLS</span> <em class="icon icon_2 https">Notice</em></a>
					<ul>
						<li><a href="#tls-certs" title="Certificates">                   <span>Certificates</span> <em class="icon icon_2 https">Notice</em></a></li>
						<li><a href="#tls-hsts"  title="HTTP Strict Transport Security"> <span>HSTS</span>         <em class="icon icon_2 https">Notice</em></a></li>
						<li><a href="#tls-hpkp"  title="HTTP Public Key Pinning">        <span>HPKP</span>         <em class="icon icon_2 https">Notice</em></a></li>
					</ul>
				</li>
				<li><a href="#csp"     title="Content Security Policy">    <span>CSP</span>     <em class="icon icon_1 https">Error</em>  </a></li>
				<li><a href="#sri"     title="Subresource Integrity">      <span>SRI</span>     <em class="icon icon_1 https">Error</em>  </a></li>
				<li><a href="#csrf"    title="Cross Site Request Forgery"> <span>CSRF</span>    <em class="icon icon_2 https">Notice</em>  </a></li>
				<li><a href="#xss"     title="Cross Site Scripting">       <span>XSS</span>     <em class="icon icon_3 https">Good</em>   </a></li>
				<li><a href="#frames"  title="Frames">                     <span>Frames</span>  <em class="icon icon_2 https">Notice</em> </a></li>
				<li><a href="#cookies" title="Cookies">                    <span>Cookies</span> <em class="icon icon_2 https">Notice</em> </a></li>
			</ul>
		</nav>
		<section id="tls">

			<h2>Transport Layer Security</h2>

			<div class="http">
				<p>This page was loaded over HTTP.</p>
			</div>

			<div class="https">

				<table>
					<tbody>
						<tr class="connection">
							<td><label for="connection">Connection</label></td>
							<td>
								<select id="connection">
									<option>https://www.google.co.uk</option>
									<option>https://www.googleapis.com</option>
									<option>https://fonts.gstatic.com</option>
									<option>https://www.google-analytics.com</option>
								</select>
							</td>
						</tr>
					</tbody>
				</table>
				<table>
					<tbody>
						<tr>
							<td>Organisation</td>
							<td>Google Inc</td>
						</tr>
						<tr>
							<td>Domains</td>
							<td>
								www.google.co.uk<br />
								google.co.uk<br />
								cdn.google.co.uk
							</td>
						</tr>
						<tr>
							<td>Certificate Authority</td>
							<td>Google Internet Authority G2</td>
						</tr>
						<tr>
							<td>Valid from</td>
							<td><time datetime="2014-10-10T12:44:30+01:00" title="10 October 2014, 11:44:30">10 October 2014</time></td>
						</tr>
						<tr>
							<td>Valid to</td>
							<td><time datetime="2015-03-10T00:00:00+01:00" title="10 March 2015, 00:00:00">10 March 2015</time></td>
						</tr>
					</tbody>
				</table>

				<h3>Protocol Details</h3>
				<table>
					<tbody>
						<tr>
							<td>TLS</td>
							<td>1.0, 1.1, 1.2</td>
						</tr>
						<tr>
							<td>SSL</td>
							<td>2, 3</td>
						</tr>
						<tr>
							<td>Key</td>
							<td>RSA 2048 bits</td>
						</tr>
						<tr>
							<td>Revocation information</td>
							<td><em class="icon icon_3">Good</em> CRL, OCSP</td>
						</tr>
						<tr>
							<td>Forward Secrecy</td>
							<td><em class="icon icon_3">Good</em> With modern browsers</td>
						</tr>
						<tr>
							<td>Next Protocol Negotiation (NPN)</td>
							<td><em class="icon icon_3">Good</em> Yes (spdy/3.1 spdy/3 http/1.1)</td>
						</tr>
						<tr>
							<td>Session resumption (caching)</td>
							<td><em class="icon icon_2">Notice</em> No (IDs assigned but not accepted)</td>
						</tr>
						<tr>
							<td>Session resumption (tickets)</td>
							<td><em class="icon icon_3">Good</em> Yes</td>
						</tr>
						<tr>
							<td>OCSP stapling</td>
							<td><em class="icon icon_3">Good</em> Yes - This reduces the time it takes to load your web page.</td>
						</tr>
					</tbody>
				</table>

			</div>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>Certificate information (especially start/end date), in an easy to view format.</li>
					<li>Protocol versions (e.g. SSLv3 and POODLE).</li>
					<li>Lists and validates revocation information.</li>
					<li>Push (or reward) additional features, such as Forward Secrecy, Sessions, OCSP stapling.</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Connection select field needs to include overall state (good/notice/error).</li>
					<li>Connection select field needs to highlight main connection.</li>
					<li>Connection select field needs to count (or list) the resources using that connection.</li>
					<li>Possibly link from <a href="./img/network.png">network tab</a>.</li>
					<li>Possibly don't display the valid from/to time (shorter).</li>
					<li>Could include cipher suite used.</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Chrome</h4>
						<p><a href="./img/alternatives/chrome/network-tab-mockup1.jpg" target="_blank"><img src="./img/alternatives/chrome/network-tab-mockup1.jpg" alt="Chrome Network Tab Mockup 1" width="445" height="210" class="screenshot" /></a></p>
						<p><a href="./img/alternatives/chrome/network-tab-mockup2.jpg" target="_blank"><img src="./img/alternatives/chrome/network-tab-mockup2.jpg" alt="Chrome Network Tab Mockup 2" width="445" height="210" class="screenshot" /></a></p>
						<p>A mockup showing an alternative location, with Annotations to highlight possible issues.</p>
						<p>Should note that the network tab is resource (not connection) based, where resources can re-use connections.</p>
						<p>For auditing purposes, you could use the "Connection ID" column.</p>
					</li>
					<li>
						<h4>Firefox</h4>
						<p><a href="./img/alternatives/firefox/security-panel.png" target="_blank"><img src="./img/alternatives/firefox/security-panel.png" alt="Firefox Security Panel" width="495" height="204" class="screenshot" /></a></p>
						<p><a href="./img/alternatives/firefox/sha1-warning.png" target="_blank"><img src="./img/alternatives/firefox/sha1-warning.png" alt="Firefox SHA1 Warning" width="503" height="110" class="screenshot" /></a></p>
						<p>Does show certificate information, protocol versions, and promotes the use of HSTS/HPKP.</p>
						<p>Does not list and validate revocation information (CRL/OCSP), or promote additional features (OCSP stapling, TLS sessions, etc).</p>
					</li>
				</ul>
			</footer>

		</section>
		<section id="tls-certs">

			<h2>Certificate Paths</h2>

			<div class="http">
				<p>This page was loaded over HTTP.</p>
			</div>

			<div class="https">

				<p>Certificate packet size: <strong>10,047</strong> bytes.</p>

				<h3>Path #1 Trusted</h3>

				<table class="cert_path">
					<tbody>
						<tr>
							<td>1</td>
							<td>
								<span><em class="icon icon_3">Good</em> <strong>Sent by server</strong> - www.google.co.uk</span>
								<span class="indent">Fingerprint: 611ea0807d5dd347435ec0b084304cdbea65df47</span>
								<span class="indent">RSA 2048 bits (e 65537) / SHA1withRSA</span>
								<span class="indent"><em class="icon icon_2">Notice</em> WEAK SIGNATURE</span>
							</td>
						</tr>
						<tr>
							<td>2</td>
							<td>
								<span><em class="icon icon_3">Good</em> <strong>Sent by server</strong> - Google Internet Authority G2</span>
								<span class="indent">Fingerprint: bbdce13e9d537a5229915cb123c7aab0a855e798</span>
								<span class="indent">RSA 2048 bits (e 65537) / SHA1withRSA</span>
								<span class="indent"><em class="icon icon_2">Notice</em> WEAK SIGNATURE</span>
							</td>
						</tr>
						<tr>
							<td>3</td>
							<td>
								<span><em class="icon icon_2">Notice</em> <strong>Extra download</strong> (already in trust store) - GeoTrust Global CA</span>
								<span class="indent">Fingerprint: de28f4a4ffe5b92fa3c503d1a349a7f9962a8212</span>
								<span class="indent">RSA 2048 bits (e 65537) / SHA1withRSA</span>
								<span class="indent"><em class="icon icon_2">Notice</em> Weak or insecure signature, but no impact on root certificate</span>
							</td>
						</tr>
					</tbody>
				</table>

				<h3>Path #2 Trusted</h3>

				<table class="cert_path">
					<tbody>
						<tr>
							<td>1</td>
							<td>
								<span><em class="icon icon_3">Good</em> <strong>Sent by server</strong> - www.google.co.uk</span>
								<span class="indent">Fingerprint: 611ea0807d5dd347435ec0b084304cdbea65df47</span>
								<span class="indent">RSA 2048 bits (e 65537)	/ SHA1withRSA</span>
								<span class="indent"><em class="icon icon_2">Notice</em> WEAK SIGNATURE</span>
							</td>
						</tr>
						<tr>
							<td>2</td>
							<td>
								<span><em class="icon icon_3">Good</em> <strong>Sent by server</strong> - Google Internet Authority G2</span>
								<span class="indent">Fingerprint: bbdce13e9d537a5229915cb123c7aab0a855e798</span>
								<span class="indent">RSA 2048 bits (e 65537)	/ SHA1withRSA</span>
								<span class="indent"><em class="icon icon_2">Notice</em> WEAK SIGNATURE</span>
							</td>
						</tr>
						<tr>
							<td>3</td>
							<td>
								<span><em class="icon icon_2">Notice</em> <strong>Not provided</strong> (requires extra download) - GeoTrust Global CA</span>
								<span class="indent">Fingerprint: 7359755c6df9a0abc3060bce369564c8ec4542a3</span>
								<span class="indent">RSA 2048 bits (e 65537)	/ SHA1withRSA</span>
								<span class="indent"><em class="icon icon_2">Notice</em> WEAK SIGNATURE</span>
							</td>
						</tr>
						<tr>
							<td>3</td>
							<td>
								<span><em class="icon icon_3">Good</em> <strong>In trust store</strong> - Equifax / Equifax Secure Certificate Authority</span>
								<span class="indent">Fingerprint: d23209ad23d314232174e40d7f9d62139786633a</span>
								<span class="indent">RSA 1024 bits (e 65537) / SHA1withRSA</span>
								<span class="indent"><em class="icon icon_2">Notice</em> WEAK KEY IN MOZILLA'S TRUST STORE</span>
								<span class="indent"><em class="icon icon_2">Notice</em> Weak or insecure signature, but no impact on root certificate</span>
							</td>
						</tr>
					</tbody>
				</table>

			</div>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>Show initial packet size, to help reduce round trips (ideally less than 10KB on a server with an IW10).</li>
					<li>List paths, fingerprints, etc.</li>
					<li>Identifies weak signatures (SHA1).</li>
					<li>Identifies missing intermediate certificates (requiring browser to download separately).</li>
					<li>Identifies extra root certificate (adding to overall packet size).</li>
					<li>Help debug connection errors (e.g. accidentally using the intermediate cert for the main cert).</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Need to consider all connections (see the main <a href="#tls">TLS</a> page).</li>
					<li>Output inspired from <a href="https://www.ssllabs.com/ssltest/index.html">ssllabs.com</a>.</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Firefox</h4>
						<p><a href="./img/alternatives/firefox/security-panel.png" target="_blank"><img src="./img/alternatives/firefox/security-panel.png" alt="Firefox Security Panel" width="495" height="204" class="screenshot" /></a></p>
						<p>Could include these features, but might be too much information?</p>
					</li>
				</ul>
			</footer>

		</section>
		<section id="tls-hsts">

			<h2>HTTP Strict Transport Security</h2>

			<div class="http">
				<p>This page was loaded over HTTP.</p>
			</div>

			<div class="https">

				<p>Instructs browsers to always use HTTPS connections.</p>

				<div class="value">
					<p><em class="icon icon_3">Good</em> HTTP website does a 301 redirect to HTTPS.</p>
					<p><em class="icon icon_2">Notice</em> HSTS header not sent (see below).</p>
					<p><em class="icon icon_2">Notice</em> Not included in this browsers preload list (<a href="https://hstspreload.appspot.com/">add</a>).</p>
				</div>

				<p>If you want everyone to connect over HTTPS, include the following header:</p>

				<p class="code">
					<code>Strict-Transport-Security: max-age=31536000; includeSubDomains; preload;</code>
				</p>

			</div>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>Checks HTTP website does a 301 redirect to HTTPS.</li>
					<li>Checks header was sent.</li>
					<li>Checks presence in browsers preload list (might not be necessary).</li>
					<li>Give example header to copy/paste (don't think there is any risk in this, as HTTPS is working).</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Need to consider all connections (see the main <a href="#tls">TLS</a> page).</li>
					<li>List when requests are rerouted due to HSTS (<a href="https://crbug.com/160571">Chrome issue 160571</a>) - also shown in Console.</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Firefox</h4>
						<p><a href="./img/alternatives/firefox/security-panel.png" target="_blank"><img src="./img/alternatives/firefox/security-panel.png" alt="Firefox Security Panel" width="495" height="204" class="screenshot" /></a></p>
						<p>Does show the use of HSTS.</p>
						<p>Does not:</p>
						<ul>
							<li>Check 301 redirect for a HTTP connection (risk of making too many requests?).</li>
							<li>Shows if the domain is in the browsers preload list (which won't scale to every website on the internet).</li>
							<li>Include an example header to use (could be risky having them copy/paste, but probably less so than from a random website).</li>
						</ul>
					</li>
				</ul>
			</footer>

		</section>
		<section id="tls-hpkp">

			<h2>HTTP Public Key Pinning</h2>

			<div class="http">
				<p>This page was loaded over HTTP.</p>
			</div>

			<div class="https">

				<p>Identifies and blocks invalid certificates for this domain.</p>

				<div class="value">
					<p><em class="icon icon_2">Notice</em> HSTS header not sent (<a href="#tls-hsts">setup</a>).</p>
					<p><em class="icon icon_2">Notice</em> HPKP header not sent.</p>
				</div>

				<p>If you want to limit the valid certificates for your domain, follow the instructions below.</p>

				<hr />

				<p>1) Create a backup key (to be used with a <abbr title="Certificate Signing Request">CSR</abbr> later):</p>

				<p class="code">
					<code>openssl genrsa -out "backup.key" 2048;</code>
				</p>

				<p>2) Store this key in a safe place (not on your server).</p>

				<p>3) Extract the base-64 encoded <abbr title="Subject Public Key Information">SPKI</abbr> fingerprint:</p>

				<p class="code">
					<code>openssl rsa  -in "backup.key" -outform der -pubout | </code>
					<code>&#xA0;&#xA0; openssl dgst -sha256 -binary | base64</code>
				</p>

				<p>4) Include the following header (report only mode):</p>

				<p class="code">
					<code>Public-Key-Pins-Report-Only:</code>
					<code>&#xA0;&#xA0; pin-sha256="OtJOVJ9HkPkdvrP3WBYf3CLY8dTaf/dmgsI9T4wT9Dw=";</code>
					<code>&#xA0;&#xA0; pin-sha256="<strong class="warning">***Backup Fingerprint***</strong>";</code>
					<code>&#xA0;&#xA0; max-age=2592000;</code>
					<code>&#xA0;&#xA0; includeSubDomains;</code>
					<code>&#xA0;&#xA0; report-uri="<strong class="warning">http://example.com/hpkp-report</strong>";</code>
				</p>

				<p><strong>Note</strong>: This example pins your current and backup keys for 30 days. Alternatively you could pin the root or intermediate certificates, which might allow you to re-issue a new certificate, but that assumes that your <abbr title="Certificate Authority">CA</abbr> will continue to use the same root/intermediate certificate, even if they have a problem.</p>

			</div>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>Checks header was sent.</li>
					<li>Give instructions on how to create a backup key (important).</li>
					<li>Give example header to copy/paste (current public key is already known, so can be pre-filled).</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Need to consider all connections (see the main <a href="#tls">TLS</a> page).</li>
					<li>Should we also complain if missing HSTS?</li>
					<li>The example sha256 pin "OtJOVJ9H..." can be worked out by the browser.</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Firefox</h4>
						<p><a href="./img/alternatives/firefox/security-panel.png" target="_blank"><img src="./img/alternatives/firefox/security-panel.png" alt="Firefox Security Panel" width="495" height="204" class="screenshot" /></a></p>
						<p>Does show the use of HPKP.</p>
						<p>Does not include an example, or warnings about this feature.</p>
					</li>
				</ul>
			</footer>

		</section>
		<section id="csp">

			<h2>Content Security Policy</h2>

			<div class="http_warning">
				<p>This page was loaded over HTTP, so the content can be changed!</p>
			</div>

			<table>
				<tbody>

					<tr>
						<th rowspan="1" scope="row">default-src</th>
						<td class="value"><em class="icon icon_closed">-</em> 'none'</td>
						<td class="help"><em class="icon icon_3">Good</em> Nice one! this is a good default!</td>
					</tr>

					<tr>
						<th rowspan="3" scope="row">style-src</th>
						<td class="value"><em class="icon icon_closed">-</em> 'self'</td>
						<td class="help"><em class="icon icon_3">Good</em> Can you specify a path?</td>
					</tr>
					<tr>
						<td class="value"><em class="icon icon_closed">-</em> '<em class="warning">unsafe-inline</em>'</td>
						<td class="help"><em class="icon icon_1">Error</em> Can introduce security issues!</td>
					</tr>
					<tr>
						<td class="value"><em class="icon icon_closed">-</em> https://*.googleapis.com</td>
						<td class="help"><em class="icon icon_3">Good</em> Can you specify a path, and remove wildcard?</td>
					</tr>

					<tr>
						<th rowspan="2" scope="row">font-src</th>
						<td class="value"><em class="icon icon_closed">-</em> 'self'</td>
						<td class="help"><em class="icon icon_3">Good</em> Can you specify a path?</td>
					</tr>
					<tr>
						<td class="value"><em class="icon icon_closed">-</em> https://fonts.gstatic.com</td>
						<td class="help"><em class="icon icon_2">Notice</em> Not used on this page?</td>
					</tr>

					<tr>
						<th rowspan="1" scope="row">img-src</th>
						<td class="value"><em class="icon icon_closed">-</em> <em class="warning">*</em></td>
						<td class="help"><em class="icon icon_2">Notice</em> Might be a bit permissive?</td>
					</tr>

					<tr>
						<th rowspan="10" scope="row">script-src</th>
						<td class="value"><em class="icon icon_open">+</em> 'self'</td>
						<td class="help"><em class="icon icon_3">Good</em> Can you specify /a/js/ as a path?</td>
					</tr>
					<tr class="usage">
						<td colspan="2">/a/js/jquery-1.11.2.js</td>
					</tr>
					<tr class="usage">
						<td colspan="2">/a/js/navigation.js</td>
					</tr>
					<tr class="usage">
						<td colspan="2">/a/js/main.js</td>
					</tr>
					<tr>
						<td class="value"><em class="icon icon_open">+</em> https://www.google-analytics.com</td>
						<td class="help"><em class="icon icon_3">Good</em> Can you specify the full url?</td>
					</tr>
					<tr class="usage">
						<td colspan="2">https://www.google-analytics.com/analytics.js</td>
					</tr>
					<tr>
						<td class="value"><em class="icon icon_open">+</em> https://*.googleapis.com</td>
						<td class="help"><em class="icon icon_2">Notice</em> Not used on this page.</td>
					</tr>
					<tr class="usage">
						<td colspan="2">N/A</td>
					</tr>
					<tr>
						<td class="value"><em class="icon icon_closed">-</em> '<em class="warning">unsafe-inline</em>'</td>
						<td class="help"><em class="icon icon_1">Error</em> Can introduce security issues!</td>
					</tr>
					<tr>
						<td class="value"><em class="icon icon_closed">-</em> '<em class="warning">unsafe-eval</em>'</td>
						<td class="help"><em class="icon icon_1">Error</em> Can introduce security issues!</td>
					</tr>

					<tr>
						<th rowspan="1" scope="row">frame-ancestors</th>
						<td class="value"><em class="icon icon_closed">-</em> 'self'</td>
						<td class="help"><em class="icon icon_2">Notice</em> This page isn't in a frame, could it be 'none'?</td>
					</tr>

					<tr>
						<th rowspan="1" scope="row">referrer</th>
						<td class="value"><em class="icon icon_closed">-</em> no-referrer</td>
						<td class="help"><em class="icon icon_3">Good</em> Nice one! this is a good default!</td>
					</tr>

					<tr>
						<th rowspan="1" scope="row">reflected-xss</th>
						<td class="value"><em class="icon icon_closed">-</em> block</td>
						<td class="help"><em class="icon icon_3">Good</em> Nice one! this is a good default!</td>
					</tr>

				</tbody>
			</table>

			<h3><em class="icon icon_open">+</em> Defaults</h3>
			<table>
				<tbody>
					<tr>
						<th rowspan="1" scope="row">base-uri</th>
						<td class="value"><em class="warning">*</em></td>
						<td class="help">Limits the &lt;base&gt; href values - used for relative URLs.</td>
					</tr>
					<tr>
						<th rowspan="1" scope="row">child-src</th>
						<td class="value">'none'</td>
						<td class="help">Limits nested browsing contexts (incorporating frame-src)</td>
					</tr>
					<tr>
						<th rowspan="1" scope="row">connect-src</th>
						<td class="value">'none'</td>
						<td class="help">Restricts where connections can be made to (e.g. AJAX requests).</td>
					</tr>
					<tr>
						<th rowspan="1" scope="row">form-action</th>
						<td class="value"><em class="warning">*</em></td>
						<td class="help">Restricts where your forms can send data to.</td>
					</tr>
					<tr>
						<th rowspan="1" scope="row">manifest-src</th>
						<td class="value">'none'</td>
						<td class="help">Restricts application manifests can be applied.</td>
					</tr>
					<tr>
						<th rowspan="1" scope="row">media-src</th>
						<td class="value">'none'</td>
						<td class="help">Restricts video, audio, and associated text that can be loaded.</td>
					</tr>
					<tr>
						<th rowspan="1" scope="row">object-src</th>
						<td class="value">'none'</td>
						<td class="help">Restricts plugins that can be loaded.</td>
					</tr>
					<tr>
						<th rowspan="1" scope="row">plugin-types</th>
						<td class="value"><em class="warning">*</em></td>
						<td class="help">Restricts plugin types (based on mime type), cannot be 'none'.</td>
					</tr>
					<tr>
						<th rowspan="1" scope="row">report-uri</th>
						<td class="value">&#xA0;</td>
						<td class="help">URL to send error reports to.</td>
					</tr>
					<tr>
						<th rowspan="1" scope="row">sandbox</th>
						<td class="value">&#xA0;</td>
						<td class="help">Applies restrictions based on &lt;iframe&gt; sandbox attribute.</td>
					</tr>
				</tbody>
			</table>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>If no CSP header was sent, propose one the developer could use.</li>
					<li>
						Uses a presentable layout, making it much easier to read than the plain text header, e.g.
						<div class="example"><code>Content-Security-Policy: default-src 'none'; connect-src 'self'; style-src 'self' fonts.googleapis.com 'unsafe-inline' s7.addthis.com; font-src 'self' fonts.gstatic.com; img-src 'self' https://www.google-analytics.com *.disqus.com *.disquscdn.com s7.addthis.com data:; script-src 'self' https://www.google-analytics.com *.disqus.com * disquscdn.com s7.addthis.com 'unsafe-eval'; frame-src disqus.com s7.addthis.com; frame-ancestors 'none'; reflected-xss block;</code></div>
					</li>
					<li>Lists the sources, one per line (did you notice the typo with the disquscdn.com script-src?)</li>
					<li>Lists the unspecified directives, and what they default to (e.g. form-action).</li>
					<li>Lists how resources match the sources (identifies unused sources).</li>
					<li>Identify when resources can match more than one source (e.g. a rouge *).</li>
					<li>Prompt the developer to be more specific (e.g. all script resources shared a common path).</li>
					<li>Prompt the developer to avoid 'unsafe-' sources (error or notice? probably ok with <a href="http://www.w3.org/TR/CSP2/#directive-script-src">nonce/hash</a>).</li>
					<li>If the developer is using a <a href="http://www.w3.org/TR/CSP2/#script-src-the-nonce-attribute">nonce</a>, perhaps request the page again to see if it changes? risky?</li>
					<li>Reinforce good decisions.</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Errors still shown in the console.</li>
					<li>In this example the defaults show 'none', because the default-src is set to 'none'.</li>
					<li>View the <a href="http://www.w3.org/TR/CSP2/">CSP2 Spec</a>, or the <a href="http://w3c.github.io/webappsec/specs/content-security-policy/">CSP3 Draft</a>.</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Chrome</h4>
						<p><a href="./img/alternatives/chrome/network-tab-mockup3.jpg" target="_blank"><img src="./img/alternatives/chrome/network-tab-mockup3.jpg" alt="Chrome Network Tab Mockup 3" width="445" height="210" class="screenshot" /></a></p>
						<p>A mockup showing the CSP information (probably no feedback) in the Network tab.</p>
						<p>Either highlight the selected resource, or only show this tab for the HTML documents that specify a CSP header.</p>
					</li>
				</ul>
			</footer>

		</section>
		<section id="sri">

			<h2>Subresource Integrity</h2>

			<div class="http_warning">
				<p>This page was loaded over HTTP, so the content can be changed!</p>
			</div>

			<div class="resource">
				<h4>https://code.jquery.com/jquery-1.10.2.min.js</h4>
				<p>ni:///sha-256;C6cv9UyIs9uJeqinPHxthvqh_E1uhG5Twh-Y5qFQmYg?ct=application/javascript</p>
				<p><em class="icon icon_3">Good</em> https://code.jquery.com/jquery-1.10.2.min.js</p>
			</div>

			<div class="resource">
				<h4>https://www.example.com/script.js</h4>
				<p>ni:///sha-256;asijfiqu4t12eqinPHWTHVqh_E1uhG5Twhakwoeji3W?ct=application/javascript</p>
				<p><em class="icon icon_3">Good</em> https://www.example.com/script.js</p>
				<p><em class="icon icon_3">Good</em> https://cdn.example.com/script.js (<strong>noncanonical</strong>)</p>
			</div>

			<div class="resource">
				<h4>http://www.example.com/script.js</h4>
				<p>ni:///sha-256;asijfiqu4t12eqinPHWTHVqh_E1uhG5Twhakwoeji3W?ct=application/javascript</p>
				<p><em class="icon icon_3">Good</em> http://www.example.com/script.js</p>
				<div class="http">
					<p><em class="icon icon_2">Notice</em> Not advisable, as HTTP requests can be edited on route (e.g. ISP optimisations).</p>
				</div>
				<div class="https">
					<p><em class="icon icon_1">Error</em> Blocked, as HTTPS was used for the main connection (resources must also be encrypted).</p>
				</div>
			</div>

			<div class="resource">
				<h4>https://www.google-analytics.com/analytics.js</h4>
				<p><em class="icon icon_2">Notice</em> No integrity check included.</p>
			</div>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>Lists all external resources (probably not from the same domain).</li>
					<li>Downloads and checks the hash for main and noncanonical resources.</li>
					<li>Warn developers that ISPs will edit content sent over HTTP (<a href="https://groups.google.com/a/chromium.org/d/msg/security-dev/hJwYZOOPaH4/SmCVRdMBLI0J">concerns raised by Joel and Chris</a>).</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Errors still shown in the console.</li>
					<li>Ensure developers don't think that loading resources over HTTP, with an integrity check, is acceptable.</li>
					<li>View the <a href="http://www.w3.org/TR/SRI/">SRI Spec</a>.</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Chrome</h4>
						<p><a href="./img/alternatives/chrome/elements-tab-mockup1.jpg" target="_blank"><img src="./img/alternatives/chrome/elements-tab-mockup1.jpg" alt="Chrome Elements Tab Mockup 1" width="445" height="221" class="screenshot" /></a></p>
						<p>Could possibly go into the Elements tab, using annotations.</p>
					</li>
				</ul>
			</footer>

		</section>
		<section id="csrf">

			<h2>Cross Site Request Forgery</h2>

			<div class="http_warning">
				<p>This page was loaded over HTTP, so the content can be changed!</p>
			</div>

			<div class="resource">
				<h4><em class="icon icon_open">+</em> Form 1: /admin/account/</h4>
				<p><em class="icon icon_3">Good</em> Does appear to be protected using a hidden field:</p>
				<ul>
					<li>id = 123</li>
					<li>action = edit</li>
					<li>csrf = <strong>f3akwau92nma9s</strong> <button>Test</button></li>
				</ul>
			</div>

			<div class="resource">
				<h4><em class="icon icon_open">+</em> Form 2: /admin/account/</h4>
				<p><em class="icon icon_2">Notice</em> Does not appear to include an appropriate hidden field:</p>
				<ul>
					<li>id = 123</li>
					<li>action = delete</li>
				</ul>
			</div>

			<div class="resource">
				<h4><em class="icon icon_open">+</em> Form 3: /contact/</h4>
				<p><em class="icon icon_2">Notice</em> Does not include any hidden fields.</p>
			</div>

			<div class="resource">
				<h4><em class="icon icon_open">+</em> Links:</h4>
				<ul>
					<li>/admin/logout/</li>
				</ul>
			</div>

			<hr />

			<p>Detection is based on the assumption that a hidden field must be present where its value cannot be guessed by another website.</p>
			<p>While it is technically possible to protect with the referrer header, it is not recommended.</p>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>Lists all forms on the page, their action, and any hidden inputs.</li>
					<li>Next to each field that looks like a CSRF value, include a button to change it, and submit the form.</li>
					<li>Lists all links on the page, not ideal, but need to reinforce that these can be vulnerable as well.</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Reinforce that this is the browser guessing, and you really should test it.</li>
					<li>Will not identify any CSRF vulnerable links (e.g. a "logout" link).</li>
					<li>Also note that a browser may prefetch pages, so not use a "delete" link (use a form).</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Chrome</h4>
						<p><a href="./img/alternatives/chrome/elements-tab-mockup1.jpg" target="_blank"><img src="./img/alternatives/chrome/elements-tab-mockup1.jpg" alt="Chrome Elements Tab Mockup 1" width="445" height="221" class="screenshot" /></a></p>
						<p>Could possibly go into the Elements tab, using annotations.</p>
					</li>
				</ul>
			</footer>

		</section>
		<section id="xss">

			<h2>Cross Site Scripting</h2>

			<div class="http_warning">
				<p>This page was loaded over HTTP, so the content can be changed!</p>
			</div>

			<div class="value">
				<h4>Header</h4>
				<p><em class="icon icon_3">Good</em> X-XSS-Protection: 1; mode=block</p>
			</div>
			<div class="value">
				<h4>Content Security Policy</h4>
				<p><em class="icon icon_3">Good</em> reflected-xss = block (<a href="#csp">review</a>)</p>
			</div>

			<hr />

			<p>This only instructs the browser to look for (and try to block) reflected XSS attacks.</p>
			<p>Ideally your website would not have any XSS vulnerabilities anyway.</p>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>Checks headers were sent.</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Reinforce that this is the browser guessing and blocking, not a fix all.</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Chrome</h4>
						<p><a href="./img/alternatives/chrome/elements-tab-mockup1.jpg" target="_blank"><img src="./img/alternatives/chrome/elements-tab-mockup1.jpg" alt="Chrome Elements Tab Mockup 1" width="445" height="221" class="screenshot" /></a></p>
						<p>Could possibly go into the Elements tab, using annotations.</p>
					</li>
				</ul>
			</footer>

		</section>
		<section id="frames">

			<h2>Framed Content</h2>

			<div class="http_warning">
				<p>This page was loaded over HTTP, so the content can be changed!</p>
			</div>

			<div class="value">
				<h4>Header</h4>
				<p><em class="icon icon_2">Notice</em> X-Frame-Options: SAMEORIGIN</p>
			</div>

			<div class="value">
				<h4>Content Security Policy</h4>
				<p><em class="icon icon_2">Notice</em> frame-ancestors = 'self' (<a href="#csp">review</a>)</p>
			</div>

			<p>As the page isn't loaded in a frame, could it be DENY?</p>

			<hr />

			<h3>Frames</h3>

			<div class="resource">
				<h4><em class="icon icon_open">+</em> /iframe/</h4>
				<p><em class="icon icon_3">Good</em> <strong>Restrictions</strong>: 'self' / SAMEORIGIN</p>
				<p><em class="icon icon_3">Good</em> <strong>Sandbox</strong>: allow-forms</p>
			</div>

			<div class="resource">
				<h4><em class="icon icon_open">+</em> /basket/</h4>
				<p><em class="icon icon_2">Notice</em> <strong>Restrictions</strong>: Not set, would ideally be "SAMEORIGIN"</p>
				<p><em class="icon icon_2">Notice</em> <strong>Sandbox</strong>: Not set, would ideally have some restrictions.</p>
			</div>

			<div class="resource">
				<h4><em class="icon icon_open">+</em> https://www.facebook.com/plugins/comments.php</h4>
				<p><em class="icon icon_2">Notice</em> <strong>Restrictions</strong>: Not set, would ideally be "ALLOW-FROM uri"</p>
				<p><em class="icon icon_2">Notice</em> <strong>Sandbox</strong>: Not set, would ideally have some restrictions.</p>
			</div>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>Checks headers were sent (i.e. can this page be framed).</li>
					<li>Prompt the developer to use something more strict (e.g. DENY).</li>
					<li>Lists each frame/iframe on the page, and show:
						<ul>
							<li>If they had the appropriate headers sent.</li>
							<li>If they have the sandbox attribute set.</li>
						</ul>
					</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Possibly suggest the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-sandbox">sandbox attribute</a> values to use.</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Chrome</h4>
						<p><a href="./img/alternatives/chrome/elements-tab-mockup1.jpg" target="_blank"><img src="./img/alternatives/chrome/elements-tab-mockup1.jpg" alt="Chrome Elements Tab Mockup 1" width="445" height="221" class="screenshot" /></a></p>
						<p>Could possibly go into the Elements tab, using annotations.</p>
					</li>
				</ul>
			</footer>

		</section>
		<section id="cookies">

			<h2>Cookies</h2>

			<div class="http_warning">
				<p>This page was loaded over HTTP, so the content can be changed!</p>
			</div>

			<table>
				<thead>
					<th scope="col">&#xA0;</th>
					<th scope="col" class="result">HTTP<br />Only</th>
					<th scope="col" class="result">Secure<br />Only</th>
				</thead>
				<tbody>
					<tr>
						<th scope="row">session</th>
						<td class="result"><em class="icon icon_3">Good</em></td>
						<td class="result"><em class="icon icon_3">Good</em></td>
					</tr>
					<tr>
						<th scope="row">username</th>
						<td class="result"><em class="icon icon_2">Notice</em></td>
						<td class="result"><em class="icon icon_3">Good</em></td>
					</tr>
					<tr>
						<th scope="row">_ga</th>
						<td class="result"><em class="icon icon_2">Notice</em></td>
						<td class="result"><em class="icon icon_2">Notice</em></td>
					</tr>
				</tbody>
			</table>

			<hr />

			<p><strong>HTTP Only</strong>: Not accessible to JavaScript, and are only sent to/from the server.</p>
			<p><strong>Secure Only</strong>: Only sent over HTTPS connections.</p>

			<footer>
				<h3>Features</h3>
				<ul>
					<li>Only lists if the cookies are HTTP Only and Secure Only.</li>
				</ul>
				<h3>Notes</h3>
				<ul>
					<li>Should link to the "Cookies" page in the "Resources" tab.</li>
					<li>Only included here to remind developers about cookie security.</li>
				</ul>
				<h3>Alternatives</h3>
				<ul>
					<li>
						<h4>Chrome</h4>
						<p><a href="./img/alternatives/chrome/cookies-mockup1.jpg" target="_blank"><img src="./img/alternatives/chrome/cookies-mockup1.jpg" alt="Chrome Cookies Mockup 1" width="445" height="131" class="screenshot" /></a></p>
						<p>Could possibly go into the Resources tab, using annotations.</p>
						<p>Does require the developer to go looking for this information.</p>
					</li>
				</ul>
			</footer>

		</section>
	</div>

	<script type="text/javascript" src="./jquery-1.11.2.min.js"></script>
	<script type="text/javascript" src="./security.js"></script>

</body>
</html>